[![CI](https://github.com/e-south/dnadesign/actions/workflows/ci.yaml/badge.svg)](https://github.com/e-south/dnadesign/actions/workflows/ci.yaml)

# dnadesign

`dnadesign` is a collection of modular bioinformatic pipelines and helper packages related to biological sequence design.

### Contents

1. [Directory layout](#directory-layout)
2. [Documentation](#documentation)
3. [Available tools](#available-tools)

---

### Directory layout

```text
dnadesign/
├─ README.md            # High-level project documentation
├─ pyproject.toml
├─ uv.lock
└── src/
    └── dnadesign/
        ├── permuter/    # in silico deep mutational scanning
        ├── infer/       # model-agnostic inference (Evo2 adapter)
        ├── densegen/    # string-packing nucleic acid assembly
        ├── opal/        # active-learning engine
        └── ...
```

---

### Documentation

1. [Installation](docs/installation.md)
2. [Maintaining dependencies](docs/dependencies.md)
3. [CUDA/GPU install notes (BU SCC)](docs/INSTALL_BU_SCC.md)

---

### Available tools

1. [**usr**](src/dnadesign/usr) (Universal Sequence Record)

      Consists of utility commands to inspect datasets/Parquet files used across the `dnadesign` project.

2. [**densegen**](src/dnadesign/densegen)

      DNA sequence design pipeline built on the integer linear programming framework from the [`dense-arrays`](https://github.com/e-south/dense-arrays) package.

2. [**infer**](src/dnadesign/infer)

      Model-agnostic wrapper for DNA/protein language models (e.g., [Evo2](https://github.com/ArcInstitute/evo2/tree/main)).

3. [**opal**](src/dnadesign/opal)

      An [EVOLVEpro-style](https://www.science.org/doi/10.1126/science.adr6006) active-learning tool for DNA/protein sequence design campaigns.

3. [**cluster**](src/dnadesign/cluster)

      A Parquet/CSV-first tool for Leiden clustering, UMAP visualisation, and a mix of other analyses.

4. [**billboard**](src/dnadesign)

      Quantifies the regulatory diversity of dense-array DNA libraries generated by **densegen**.

5.  [**libshuffle**](src/dnadesign/libshuffle)

      Iteratively subsamples sequence libraries from the sibling **sequences** directory and computes diversity metrics using the **billboard** pipeline as its engine.

6.	[**nmf**](src/dnadesign/nmf)

      Applies Non-Negative Matrix Factorization (NMF) to a library of sequences generated by **densegen** to uncover higher-order transcription factor binding site combinations.

7.  [**latdna**](src/dnadesign/latdna)

      Pipeline for latent space analysis of DNA sequences.

8. [**cruncher**](src/dnadesign/cruncher)

      Pipeline that parses TF position-weight matrices (MEME, JASPAR, etc.) via plug-in parsers, and then runs a discrete Categorical Gibbs optimiser (or other plug-ins) to discover short DNA sequences that score highly on one or more TFs.

9. [**tfkdanalysis**](src/dnadesign/tfkdanalysis)

      Pipeline for analyzing transcription factor knockdown (TFKD) effects using PPTP-seq (Promoter responses to TF perturbation sequencing) data—a high-throughput approach described in [Han *et al.* (2023)](https://doi.org/10.1038/s41467-023-41572-4).

12. [**aligner**](src/dnadesign/aligner)

      Wrapper for Biopython's [PairwiseAligner](https://biopython.org/docs/dev/Tutorial/chapter_pairwise.html#chapter-pairwise), which is a class for computing Needleman–Wunsch global alignment scores between nucleotide sequences.

13. [**permuter**](src/dnadesign/permuter)

      Pipeline for biological sequence permutation and subsequent evaluation workflows.
14. [**archived**](src/dnadesign/archived)

      Contains a mix of old legacy projects and prototypes.

---

@e-south
