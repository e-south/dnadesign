cruncher:
  out_dir: outputs
  regulator_sets:
    - [lexA, cpxR]

  io:
    parsers:
      extra_modules: []

  motif_store:
    catalog_root: .cruncher
    source_preference: [meme_suite_meme, meme_suite_streme, demo_local_meme, regulondb]
    allow_ambiguous: false
    pwm_source: matrix
    site_kinds: null
    combine_sites: true
    dataset_preference: []
    dataset_map: {}
    # Required for pwm_source=sites (site-derived PWMs need fixed-length inputs).
    # This does NOT affect MEME/STREME discovery unless motif_discovery.window_sites=true.
    site_window_lengths:
      lexA: 20
      cpxR: 20
    site_window_center: midpoint
    min_sites_for_pwm: 2
    allow_low_sites: false

  motif_discovery:
    source_id: meme_suite_streme

  ingest:
    genome_source: ncbi
    genome_fasta: null
    genome_cache: .cruncher/genomes
    genome_assembly: null
    contig_aliases: {}
    ncbi_email: null
    ncbi_tool: cruncher
    ncbi_api_key: null
    ncbi_timeout_seconds: 30
    http:
      retries: 3
      backoff_seconds: 0.5
      max_backoff_seconds: 8.0
      retry_statuses: [429, 500, 502, 503, 504]
      respect_retry_after: true
    regulondb:
      base_url: https://regulondb.ccg.unam.mx/graphql
      verify_ssl: true
      ca_bundle: null
      timeout_seconds: 30
      motif_matrix_source: alignment
      alignment_matrix_semantics: probabilities
      min_sites_for_pwm: 2
      allow_low_sites: false
      curated_sites: true
      ht_sites: false
      ht_dataset_sources: null
      ht_dataset_type: TFBINDING
      ht_binding_mode: tfbinding
      uppercase_binding_site_only: true
    local_sources:
      - source_id: demo_local_meme
        description: Demo DAP-seq motifs + sites (local MEME files)
        root: inputs/local_motifs
        patterns: ["*.txt"]
        recursive: false
        format_map: {".txt": "MEME"}
        tf_name_strategy: stem
        matrix_semantics: probabilities
        extract_sites: true
        organism:
          name: Escherichia coli
        citation: "Local demo DAP-seq motifs (MEME text, bundled with cruncher demo)"
        tags:
          demo: "true"
          format: meme
          assay: dapseq

  parse:
    plot:
      logo: true
      bits_mode: information
      dpi: 150

  sample:
    mode: optimize
    rng:
      seed: 42
      deterministic: true
    budget:
      tune: 1000
      draws: 2000
      restarts: 4
    early_stop:
      enabled: true
      patience: 500
      min_delta: 0.01
      require_min_unique: true
      min_unique: 10
      success_min_per_tf_norm: 0.60
    init:
      kind: random
      length: 30
      pad_with: background
    objective:
      bidirectional: true
      score_scale: normalized-llr
      scoring:
        pwm_pseudocounts: 0.10
        log_odds_clip: null
      softmin:
        enabled: true
        kind: linear
        beta: [0.5, 10.0]
    elites:
      k: 10
      selection:
      policy: mmr
      pool_size: 1000
      alpha: 0.85
      relevance: min_per_tf_norm
      filters:
        pwm_sum_min: 0.0
        min_per_tf_norm: 0.60
        require_all_tfs_over_min_norm: true
    moves:
      profile: balanced
      overrides:
        block_len_range: [4, 16]
        multi_k_range: [3, 10]
        slide_max_shift: 4
        swap_len_range: [2, 8]
        move_probs:
          S: 0.35
          B: 0.30
          M: 0.35
    optimizer:
      name: auto
    optimizers:
      pt:
        beta_ladder:
          kind: geometric
          beta_min: 0.2
          beta_max: 25.0
          n_temps: 4
        swap_prob: 0.10
    auto_opt:
      enabled: true
      budget_levels: [2000, 3000]
      replicates: 1
      move_profiles: [balanced]
      cooling_boosts: [1.0]
      pt_swap_probs: [0.10]
      policy:
        allow_warn: true
    output:
      save_sequences: true
      include_consensus_in_elites: false
      live_metrics: true
      trace:
        save: true
        include_tune: false
    ui:
      progress_bar: true
      progress_every: 0

  analysis:
    runs: []
    extra_tables: true
    tf_pair: [lexA, cpxR]
    plots:
      worst_tf_trace: true
      worst_tf_identity: true
      elite_filter_waterfall: true
      overlap_heatmap: true
      overlap_bp_distribution: true
    scatter_scale: llr
    subsampling_epsilon: 10.0
