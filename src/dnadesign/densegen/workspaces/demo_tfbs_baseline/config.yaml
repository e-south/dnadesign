# DenseGen demo: binding-site baseline plus sigma70-constrained variant.
densegen:
  schema_version: "2.9"
  run:
    id: demo_tfbs_baseline
    root: "."

  inputs:
    - name: basic_sites
      type: binding_sites
      path: inputs/sites.csv

  output:
    targets: [parquet]
    schema:
      bio_type: dna
      alphabet: dna_4
    parquet:
      path: outputs/tables/records.parquet
      deduplicate: true
      chunk_size: 64

  generation:
    sequence_length: 60
    sampling:
      pool_strategy: full
      library_size: 3
      unique_binding_sites: true
      unique_binding_cores: true
      relax_on_exhaustion: false
    plan:
      - name: baseline
        quota: 9
        sampling:
          include_inputs: [basic_sites]
        regulator_constraints:
          groups: []
      - name: baseline_sigma70
        quota: 6
        sampling:
          include_inputs: [basic_sites]
        fixed_elements:
          promoter_constraints:
            - name: sigma70_consensus
              upstream: TTGACA
              downstream: TATAAT
              spacer_length: [16, 18]
        regulator_constraints:
          groups: []

  solver:
    backend: CBC
    strategy: iterate
    time_limit_seconds: 5

  runtime:
    round_robin: false
    arrays_generated_before_resample: 1
    min_count_per_tf: 0
    max_duplicate_solutions: 3
    stall_seconds_before_resample: 10
    stall_warning_every_seconds: 10
    max_consecutive_failures: 25
    max_seconds_per_plan: 60
    max_failed_solutions: 0
    random_seed: 42

  postprocess:
    pad:
      mode: adaptive
      end: 5prime
      gc:
        mode: range
        min: 0.40
        max: 0.60
        target: 0.50
        tolerance: 0.10
        min_pad_length: 0
      max_tries: 2000

  logging:
    log_dir: outputs/logs
    level: INFO
    progress_style: summary

plots:
  source: parquet
  out_dir: outputs/plots
  format: pdf
  default: [placement_map]
