2026-01-13 16:35:07 | INFO | dnadesign.densegen.src.logging_utils | Logging initialized (level=INFO)
Quota plan: smoke=5
2026-01-13 16:35:07 | INFO | dnadesign.densegen.src.main | Solver selected: CBC
2026-01-13 16:35:08 | INFO | dnadesign.densegen.src.main | Library for smoke/smoke: 10 motifs | TF counts: lexa×5, cpxr×5
╭───────────────────── Traceback (most recent call last) ──────────────────────╮
│ /Users/Shockwing/Dropbox/projects/phd/dnadesign-densegen-refactor/src/dnades │
│ ign/densegen/src/main.py:711 in run                                          │
│                                                                              │
│   708 │   │   │   │   │   if current >= quota:                               │
│   709 │   │   │   │   │   │   continue                                       │
│   710 │   │   │   │   │   done = False                                       │
│ ❱ 711 │   │   │   │   │   produced = _process_plan_for_source(               │
│   712 │   │   │   │   │   │   s,                                             │
│   713 │   │   │   │   │   │   item,                                          │
│   714 │   │   │   │   │   │   cfg,                                           │
│                                                                              │
│ ╭───────────────────────────────── locals ─────────────────────────────────╮ │
│ │             cfg = DenseGenConfig(                                        │ │
│ │                   │   inputs=[                                           │ │
│ │                   │   │   CSVTFBSInput(                                  │ │
│ │                   │   │   │   name='smoke',                              │ │
│ │                   │   │   │   type='csv_tfbs',                           │ │
│ │                   │   │   │                                              │ │
│ │                   path='../inputs/tf2tfbs_mapping_cpxR_LexA.csv',        │ │
│ │                   │   │   │   columns=CSVTFBSColumns(                    │ │
│ │                   │   │   │   │   tf='tf',                               │ │
│ │                   │   │   │   │   tfbs='tfbs'                            │ │
│ │                   │   │   │   )                                          │ │
│ │                   │   │   )                                              │ │
│ │                   │   ],                                                 │ │
│ │                   │   output=OutputConfig(                               │ │
│ │                   │   │   kind='jsonl',                                  │ │
│ │                   │   │   usr=None,                                      │ │
│ │                   │   │   jsonl=OutputJSONLConfig(                       │ │
│ │                   │   │   │   path='../outputs/smoke.jsonl',             │ │
│ │                   │   │   │   bio_type='dna',                            │ │
│ │                   │   │   │   alphabet='dna_4',                          │ │
│ │                   │   │   │   deduplicate=True                           │ │
│ │                   │   │   )                                              │ │
│ │                   │   ),                                                 │ │
│ │                   │   generation=GenerationConfig(                       │ │
│ │                   │   │   sequence_length=60,                            │ │
│ │                   │   │   quota=5,                                       │ │
│ │                   │   │   sampling=SamplingConfig(                       │ │
│ │                   │   │   │   subsample_over_length_budget_by=120,       │ │
│ │                   │   │   │   cover_all_tfs=True,                        │ │
│ │                   │   │   │   unique_binding_sites=True,                 │ │
│ │                   │   │   │   max_sites_per_tf=None,                     │ │
│ │                   │   │   │   relax_on_exhaustion=False,                 │ │
│ │                   │   │   │   allow_incomplete_coverage=False,           │ │
│ │                   │   │   │   subsample_size=16                          │ │
│ │                   │   │   ),                                             │ │
│ │                   │   │   plan=[                                         │ │
│ │                   │   │   │   PlanItem(                                  │ │
│ │                   │   │   │   │   name='smoke',                          │ │
│ │                   │   │   │   │   quota=5,                               │ │
│ │                   │   │   │   │   fraction=None,                         │ │
│ │                   │   │   │   │   fixed_elements=FixedElements(          │ │
│ │                   │   │   │   │   │   promoter_constraints=[             │ │
│ │                   │   │   │   │   │   │   PromoterConstraint(            │ │
│ │                   │   │   │   │   │   │   │   name=None,                 │ │
│ │                   │   │   │   │   │   │   │   upstream='TTGACA',         │ │
│ │                   │   │   │   │   │   │   │   downstream='TATAAT',       │ │
│ │                   │   │   │   │   │   │   │   spacer_length=(16, 18),    │ │
│ │                   │   │   │   │   │   │   │   upstream_pos=(0, 60),      │ │
│ │                   │   │   │   │   │   │   │   downstream_pos=None        │ │
│ │                   │   │   │   │   │   │   )                              │ │
│ │                   │   │   │   │   │   ],                                 │ │
│ │                   │   │   │   │   │   side_biases=None                   │ │
│ │                   │   │   │   │   )                                      │ │
│ │                   │   │   │   )                                          │ │
│ │                   │   │   ]                                              │ │
│ │                   │   ),                                                 │ │
│ │                   │   solver=SolverConfig(                               │ │
│ │                   │   │   backend='CBC',                                 │ │
│ │                   │   │   diverse_solution=False,                        │ │
│ │                   │   │   options=[]                                     │ │
│ │                   │   ),                                                 │ │
│ │                   │   runtime=RuntimeConfig(                             │ │
│ │                   │   │   round_robin=True,                              │ │
│ │                   │   │   arrays_generated_before_resample=2,            │ │
│ │                   │   │   min_count_per_tf=0,                            │ │
│ │                   │   │   max_duplicate_solutions=3,                     │ │
│ │                   │   │   stall_seconds_before_resample=10,              │ │
│ │                   │   │   stall_warning_every_seconds=10,                │ │
│ │                   │   │   max_resample_attempts=2,                       │ │
│ │                   │   │   max_total_resamples=50,                        │ │
│ │                   │   │   max_seconds_per_plan=0,                        │ │
│ │                   │   │   max_failed_solutions=0,                        │ │
│ │                   │   │   random_seed=42                                 │ │
│ │                   │   ),                                                 │ │
│ │                   │   postprocess=PostprocessConfig(                     │ │
│ │                   │   │   gap_fill=GapFillConfig(                        │ │
│ │                   │   │   │   mode='adaptive',                           │ │
│ │                   │   │   │   end='5prime',                              │ │
│ │                   │   │   │   gc_min=0.4,                                │ │
│ │                   │   │   │   gc_max=0.6,                                │ │
│ │                   │   │   │   max_tries=2000                             │ │
│ │                   │   │   )                                              │ │
│ │                   │   ),                                                 │ │
│ │                   │   logging=LoggingConfig(                             │ │
│ │                   │   │   level='INFO',                                  │ │
│ │                   │   │   suppress_solver_stderr=True,                   │ │
│ │                   │   │   print_visual=False                             │ │
│ │                   │   )                                                  │ │
│ │                   )                                                      │ │
│ │        cfg_path = PosixPath('src/dnadesign/densegen/jobs/smoke.yaml')    │ │
│ │   chosen_solver = 'CBC'                                                  │ │
│ │          config = PosixPath('src/dnadesign/densegen/jobs/smoke.yaml')    │ │
│ │             ctx = <click.core.Context object at 0x10f06a0f0>             │ │
│ │         current = 0                                                      │ │
│ │ default_logfile = PosixPath('/Users/Shockwing/Dropbox/projects/phd/dnad… │ │
│ │            done = False                                                  │ │
│ │          inputs = [                                                      │ │
│ │                   │   CSVTFBSInput(                                      │ │
│ │                   │   │   name='smoke',                                  │ │
│ │                   │   │   type='csv_tfbs',                               │ │
│ │                   │   │                                                  │ │
│ │                   path='../inputs/tf2tfbs_mapping_cpxR_LexA.csv',        │ │
│ │                   │   │   columns=CSVTFBSColumns(tf='tf', tfbs='tfbs')   │ │
│ │                   │   )                                                  │ │
│ │                   ]                                                      │ │
│ │            item = ResolvedPlanItem(                                      │ │
│ │                   │   name='smoke',                                      │ │
│ │                   │   quota=5,                                           │ │
│ │                   │   fixed_elements=FixedElements(                      │ │
│ │                   │   │   promoter_constraints=[                         │ │
│ │                   │   │   │   PromoterConstraint(                        │ │
│ │                   │   │   │   │   name=None,                             │ │
│ │                   │   │   │   │   upstream='TTGACA',                     │ │
│ │                   │   │   │   │   downstream='TATAAT',                   │ │
│ │                   │   │   │   │   spacer_length=(16, 18),                │ │
│ │                   │   │   │   │   upstream_pos=(0, 60),                  │ │
│ │                   │   │   │   │   downstream_pos=None                    │ │
│ │                   │   │   │   )                                          │ │
│ │                   │   │   ],                                             │ │
│ │                   │   │   side_biases=None                               │ │
│ │                   │   )                                                  │ │
│ │                   )                                                      │ │
│ │             key = ('smoke', 'smoke')                                     │ │
│ │          loaded = LoadedConfig(                                          │ │
│ │                   │                                                      │ │
│ │                   path=PosixPath('/Users/Shockwing/Dropbox/projects/phd… │ │
│ │                   │   root=RootConfig(                                   │ │
│ │                   │   │   densegen=DenseGenConfig(                       │ │
│ │                   │   │   │   inputs=[                                   │ │
│ │                   │   │   │   │   CSVTFBSInput(                          │ │
│ │                   │   │   │   │   │   name='smoke',                      │ │
│ │                   │   │   │   │   │   type='csv_tfbs',                   │ │
│ │                   │   │   │   │   │                                      │ │
│ │                   path='../inputs/tf2tfbs_mapping_cpxR_LexA.csv',        │ │
│ │                   │   │   │   │   │   columns=CSVTFBSColumns(            │ │
│ │                   │   │   │   │   │   │   tf='tf',                       │ │
│ │                   │   │   │   │   │   │   tfbs='tfbs'                    │ │
│ │                   │   │   │   │   │   )                                  │ │
│ │                   │   │   │   │   )                                      │ │
│ │                   │   │   │   ],                                         │ │
│ │                   │   │   │   output=OutputConfig(                       │ │
│ │                   │   │   │   │   kind='jsonl',                          │ │
│ │                   │   │   │   │   usr=None,                              │ │
│ │                   │   │   │   │   jsonl=OutputJSONLConfig(               │ │
│ │                   │   │   │   │   │   path='../outputs/smoke.jsonl',     │ │
│ │                   │   │   │   │   │   bio_type='dna',                    │ │
│ │                   │   │   │   │   │   alphabet='dna_4',                  │ │
│ │                   │   │   │   │   │   deduplicate=True                   │ │
│ │                   │   │   │   │   )                                      │ │
│ │                   │   │   │   ),                                         │ │
│ │                   │   │   │   generation=GenerationConfig(               │ │
│ │                   │   │   │   │   sequence_length=60,                    │ │
│ │                   │   │   │   │   quota=5,                               │ │
│ │                   │   │   │   │   sampling=SamplingConfig(               │ │
│ │                   │   │   │   │   │                                      │ │
│ │                   subsample_over_length_budget_by=120,                   │ │
│ │                   │   │   │   │   │   cover_all_tfs=True,                │ │
│ │                   │   │   │   │   │   unique_binding_sites=True,         │ │
│ │                   │   │   │   │   │   max_sites_per_tf=None,             │ │
│ │                   │   │   │   │   │   relax_on_exhaustion=False,         │ │
│ │                   │   │   │   │   │   allow_incomplete_coverage=False,   │ │
│ │                   │   │   │   │   │   subsample_size=16                  │ │
│ │                   │   │   │   │   ),                                     │ │
│ │                   │   │   │   │   plan=[                                 │ │
│ │                   │   │   │   │   │   PlanItem(                          │ │
│ │                   │   │   │   │   │   │   name='smoke',                  │ │
│ │                   │   │   │   │   │   │   quota=5,                       │ │
│ │                   │   │   │   │   │   │   fraction=None,                 │ │
│ │                   │   │   │   │   │   │   fixed_elements=FixedElements(  │ │
│ │                   │   │   │   │   │   │   │   promoter_constraints=[     │ │
│ │                   │   │   │   │   │   │   │   │   PromoterConstraint(    │ │
│ │                   │   │   │   │   │   │   │   │   │   name=None,         │ │
│ │                   │   │   │   │   │   │   │   │   │   upstream='TTGACA', │ │
│ │                   │   │   │   │   │   │   │   │   │                      │ │
│ │                   downstream='TATAAT',                                   │ │
│ │                   │   │   │   │   │   │   │   │   │   spacer_length=(    │ │
│ │                   │   │   │   │   │   │   │   │   │   │   16,            │ │
│ │                   │   │   │   │   │   │   │   │   │   │   18             │ │
│ │                   │   │   │   │   │   │   │   │   │   ),                 │ │
│ │                   │   │   │   │   │   │   │   │   │   upstream_pos=(     │ │
│ │                   │   │   │   │   │   │   │   │   │   │   0,             │ │
│ │                   │   │   │   │   │   │   │   │   │   │   60             │ │
│ │                   │   │   │   │   │   │   │   │   │   ),                 │ │
│ │                   │   │   │   │   │   │   │   │   │                      │ │
│ │                   downstream_pos=None                                    │ │
│ │                   │   │   │   │   │   │   │   │   )                      │ │
│ │                   │   │   │   │   │   │   │   ],                         │ │
│ │                   │   │   │   │   │   │   │   side_biases=None           │ │
│ │                   │   │   │   │   │   │   )                              │ │
│ │                   │   │   │   │   │   )                                  │ │
│ │                   │   │   │   │   ]                                      │ │
│ │                   │   │   │   ),                                         │ │
│ │                   │   │   │   solver=SolverConfig(                       │ │
│ │                   │   │   │   │   backend='CBC',                         │ │
│ │                   │   │   │   │   diverse_solution=False,                │ │
│ │                   │   │   │   │   options=[]                             │ │
│ │                   │   │   │   ),                                         │ │
│ │                   │   │   │   runtime=RuntimeConfig(                     │ │
│ │                   │   │   │   │   round_robin=True,                      │ │
│ │                   │   │   │   │   arrays_generated_before_resample=2,    │ │
│ │                   │   │   │   │   min_count_per_tf=0,                    │ │
│ │                   │   │   │   │   max_duplicate_solutions=3,             │ │
│ │                   │   │   │   │   stall_seconds_before_resample=10,      │ │
│ │                   │   │   │   │   stall_warning_every_seconds=10,        │ │
│ │                   │   │   │   │   max_resample_attempts=2,               │ │
│ │                   │   │   │   │   max_total_resamples=50,                │ │
│ │                   │   │   │   │   max_seconds_per_plan=0,                │ │
│ │                   │   │   │   │   max_failed_solutions=0,                │ │
│ │                   │   │   │   │   random_seed=42                         │ │
│ │                   │   │   │   ),                                         │ │
│ │                   │   │   │   postprocess=PostprocessConfig(             │ │
│ │                   │   │   │   │   gap_fill=GapFillConfig(                │ │
│ │                   │   │   │   │   │   mode='adaptive',                   │ │
│ │                   │   │   │   │   │   end='5prime',                      │ │
│ │                   │   │   │   │   │   gc_min=0.4,                        │ │
│ │                   │   │   │   │   │   gc_max=0.6,                        │ │
│ │                   │   │   │   │   │   max_tries=2000                     │ │
│ │                   │   │   │   │   )                                      │ │
│ │                   │   │   │   ),                                         │ │
│ │                   │   │   │   logging=LoggingConfig(                     │ │
│ │                   │   │   │   │   level='INFO',                          │ │
│ │                   │   │   │   │   suppress_solver_stderr=True,           │ │
│ │                   │   │   │   │   print_visual=False                     │ │
